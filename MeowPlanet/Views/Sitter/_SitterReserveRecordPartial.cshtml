@model IEnumerable<MeowPlanet.ViewModels.Sitters.SitterRecordViewModel>;
@{
    int i = 0;
}

<style> 
/* 顏色 */
:root {
    --project-bg-color: #171B20;
    --project-primary-color: #B99668;
    --project-primary-color-buzz: rgba(185, 150, 104, 0.5);
    --project-pink-color: #FF8EFF;
    --project-pink-color-buzz: rgba(255, 142, 255, 0.5);
    --project-gray-color: #4B5461;
    --project-gray-color-buzz: rgba(75, 84, 97, 0.5);
    --project-green-color: #2A483A;
    --project-green-color-buzz: rgba(42, 72, 58, 0.5);
    --project-txt-color: #ffffff;
    --project-txt-color-buzz: rgba(255, 255, 255, 0.5);
    --project-scroll-color: #b996689c;
}

/* width */
::-webkit-scrollbar {
    width: 8px;
}

/* Track */
::-webkit-scrollbar-track {
    box-shadow: inset 0 0 5px grey;
    border-radius: 10px;
    margin-top: 10px;
    margin-bottom: 10px;
}

/* Handle */
::-webkit-scrollbar-thumb {
    background: var(--project-primary-color);
    border-radius: 10px;
}

    /* Handle on hover */
    ::-webkit-scrollbar-thumb:hover {
        background: #b99668e5;
    }

.div0 {
    width: 950px;
    height: 660px;
    margin: auto;
    margin-top: 20px;
    color: rgb(255, 255, 255);
}


.div1 {
    width: 850px;
    height: 610px;
    margin: 0 auto;
    border-bottom-left-radius: 15px;
    border-bottom-right-radius: 15px;
    padding-bottom:10px;
}

.div1-01 {
    font-size: 20px;
    margin: 20px 0px 10px 35px;
    color: #B99668;
    font-weight: 900;
}

.div1-1 {
    width: 770px;
    margin: 0 auto;
    /* 太空感  */
    color: rgb(134, 171, 190, 0.5);
    padding: 1rem;
    border: 2px rgb(150, 152, 155) solid;
    box-shadow: 0 0 0.7rem rgba(245, 251, 253, 0.541) inset;
    background: rgba(0, 0, 0, .3);
    border-radius: 25px;
    background-color: #041325;
    /* 轉成DIV特性 */
    display: block;
    margin: 0 auto;
}

.div2 {
    display: flex;
    height: 20px;
    align-items: center;
    padding: 0px 10px 0px 20px;
   
}

.div2-1 {
    width: 700px;
    font-size: 17px;
    /* 粗體 */
    font-weight: 900;
    color: rgb(209, 209, 209);
    display: flex;
    cursor: pointer;
}
.div2-1-1 {
    width: 210px;
    text-align: left;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    cursor: pointer;
}
.div2-1-2 {
    width: 400px;
    text-align: left;
    cursor: pointer;
}
.div2-2 {
    padding-left: 30px;
    color: rgb(255, 255, 255);
    cursor: pointer;
}

.div3 {
    width: 700px;
    height: 290px;
    padding: 5px 40px 0px 20px;
    margin: 25px 20px 10px 20px;
    border-radius: 5px;
    /* 字中 */
    text-align: left;
}
.div3-1 {
    width: 700px;
    height: 200px;
    padding: 5px 40px 0px 20px;
    margin: 25px 20px 10px 20px;
    border-radius: 5px;
    /* 字中 */
    text-align: left;
}

.div4 {
    width: 600px;
    margin: 15px 0px 20px 20px;
    display: flex;
}

.div4-1 {
    margin-top: 15px;
    width: 150px;
    height: 150px;
    /*margin-right: 30px;*/
}

    .div4-1 img {
        width: 100%;
        border-radius: 15px;
        display: block;
        margin: auto;
        object-fit: cover;
        height: 100%;
    }

.div4-2 {
    width:450px;
    padding-left:20px;
    font-size: 20px;
    color: rgb(255, 255, 255);
}

.div4-2-1 {
    width: 400px;
    color: rgb(255, 255, 255);
    font-size: 20px;
    margin: 0px 0px 0px 20px;
}

.div4-2-2 {
    width: 400px;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
}

.div5 {
    text-align: center;
    display: flex;
    margin-top: 35px;
}

.div5-1 {
    width: 550px;
    height: 55px;
    font-size: 20px;
    /*margin-left: 80px;*/
    margin: 0 auto;
    border-radius: 10px;
    line-height: 15px;
    font-weight: 800;
    color: rgb(255, 255, 255);
    padding: 1rem;
    border: 2px rgb(142, 255, 212, 0.767) solid;
    box-shadow: 0 0 0.7rem rgba(142, 255, 212, 0.767) inset;
    background: rgba(0, 0, 0, .3);
    border-radius: 20px;
    /* but轉成DIV特性 */
    display: block;
}

.div5-2 {
    width: 550px;
    height: 55px;
    font-size: 20px;
    /*margin-left: 80px;*/
    margin: 0 auto;
    border-radius: 10px;
    line-height: 15px;
    font-weight: 800;
    color: rgb(255, 255, 255);
    padding: 1rem;
    border: 2px rgba(0, 150, 209, 0.829) solid;
    box-shadow: 0 0 0.7rem rgba(0, 150, 209, 0.829) inset;
    background: rgba(0, 0, 0, .3);
    border-radius: 20px;
    /* but轉成DIV特性 */
    display: block;
}


/* 評論彈出------------------------------------------*/
.swal2-modal {
    background-color: var(--project-bg-color);
    border: 2px var(--project-txt-color) solid;
    box-shadow: 0 0 1.5rem var(--project-txt-color-buzz) inset;
    border-radius: 2%;
}

.div6-1 {
    margin-bottom: 15px;
}

.div6-2 {
    text-align: left;
    margin-bottom: 10px;
    
}

.div6-2-1 {
    margin-top: 30px;
    color: rgb(185, 150, 104);
}

.div7 {
    font-size: 55px;
    margin-right: 30px;
    color: rgb(185, 150, 104);
    cursor: pointer;
}

.div8 {
    /*width: 500px;*/
    margin: 60px 0px 10px 70px;
    
}

.div9 {
    width: 550px;
    height: 240px;
    margin-left: 60px;
    margin-top: 20px;
    font-size: 20px;
    /* 太空感  */
    color: rgb(248, 248, 248);
    padding: 1rem;
    border: 2px rgb(219, 232, 248) solid;
    box-shadow: 0 0 0.5rem rgba(134, 171, 190, 0.5) inset;
    background: rgba(0, 0, 0, .3);
    border-radius: 25px;
}

.div10 {
    width: 180px;
    height: 45px;
    font-size: 17px;
    margin: 45px 0px 0px 240px;
    border-radius: 10px;
    line-height: 5px;
    font-weight: 800;
    color: rgb(255, 255, 255);
    padding: 1rem;
    border: 2px rgb(142, 255, 212, 0.767) solid;
    box-shadow: 0 0 0.5rem rgba(142, 255, 212, 0.767) inset;
    background: rgba(0, 0, 0, .3);
    border-radius: 20px;
    /* but轉成DIV特性 */
    display: block;
}

.div11 {
    /*width: 50px;
    height: 50px;*/
   
}

#div12 {
    /*overflow: hidden;*/
    /*width: 500px;*/
    display: flex;
}
    #div12 li {
        float: left;
        width: 100px;
        height: 100px;
        margin: 2px;
        font-size: 150px;
        display: inline;
        color: #999;
        font: bold 55px arial;
        cursor: pointer;
        color: rgb(97, 97, 97);
    }

    #div12 .act {
        color: rgb(185, 150, 104);
    }



</style>
<div class="div0">
    <div style="overflow-y: auto;">
        <div id="accordionExample" class="div1">

            <div class="div1-01"><i class="fa-solid fa-user-clock"></i> &nbsp 訂 &nbsp 單 &nbsp 狀 &nbsp 態 &nbsp<span style="font-size:15px;">| &nbsp 保姆尚未接單 </span></div>

            @foreach (var item in Model)
            {
                if (item.Status == 0)
                {
                    string collapse = "collapse" + i;

                    <button class="div1-1">

                        <!-- data-target="#collapse【1】"***需更改數字*** -->
                            <div data-toggle="collapse" data-target="#@collapse" class="div2">
                            <div class="div2-1">                                
                                <div class="div2-1-1"><i class="fa-solid fa-user-large"></i> &nbsp &nbsp 保姆名稱: @item.SitterName &nbsp</div>
                                        <div class="div2-1-2">| &nbsp &nbsp 入宿日期:@item.DateStart.ToString("yyyy年MM月dd日") - @item.DateOver.ToString("MM月dd日") &nbsp (共 @item.DateOver.Subtract(item.DateStart).ToString("%d") 日)</div>
                            </div>
                            <div class="div2-2">
                                <i class="fa-solid fa-angles-down"></i>
                            </div>
                        </div>
                        <!-- id="collapse【1】"***需更改數字***   -->
                                <div id="@collapse" class="div3 collapse card-body" data-parent="#accordionExample">
                            <!-- 訂單細項 -->
                            <div class="div4">
                                <div class="div4-1">
                                  <img src="@item.SitterPhoto" alt="">
                                </div>
                                <div class="div4-2">

                                    <div class="div4-2-1">
                                        <div>保姆名稱 &nbsp : &nbsp @item.SitterName </div>
                                        <div>保姆地址 &nbsp : &nbsp * 於保姆接單後顯示 *</div>
                                        <div>保姆電話 &nbsp : &nbsp * 於保姆接單後顯示 *</div>
                                        <div>入宿日期 &nbsp : &nbsp @item.DateStart.ToString("yyyy/MM/dd") - @item.DateOver.ToString("yyyy/MM/dd")</div>
                                        <div>入宿貓咪 &nbsp : &nbsp @item.CatName</div>
                                        <div>總共費用 &nbsp : &nbsp 新台幣 @item.Total 元</div>
                                    </div>
                                </div>
                            </div>
                            <div class="div5">
                                <div  type="button" class="div5-2" data-order-id="@item.OrderId" data-status="4">取消訂單</div>
                            </div>
                        </div>
                    </button>

                    i++;
                }
            }


             <div class="div1-01"><i class="fa-solid fa-clock"></i>&nbsp &nbsp 預 &nbsp 約 &nbsp 資 &nbsp 訊 &nbsp<span style="font-size:15px;">| &nbsp 完成請行評價 </span></div>

            @foreach (var item in Model)
            {
                if (item.Status == 1)
                {
                    string collapse = "collapse" + i;

                    <button class="div1-1">

                        <!-- data-target="#collapse【1】"***需更改數字*** -->
                        <div data-toggle="collapse" data-target="#@collapse" class="div2">
                            <div class="div2-1">                                
                                <div class="div2-1-1"><i class="fa-solid fa-user-large"></i> &nbsp &nbsp 保姆名稱: @item.SitterName &nbsp</div>
                                        <div class="div2-1-2">| &nbsp &nbsp 入宿日期:@item.DateStart.ToString("yyyy年MM月dd日") - @item.DateOver.ToString("MM月dd日") &nbsp (共 @item.DateOver.Subtract(item.DateStart).ToString("%d") 日)</div>
                            </div>
                            <div class="div2-2">
                                <i class="fa-solid fa-angles-down"></i>
                            </div>
                        </div>
                        <!-- id="collapse【1】"***需更改數字***   -->
                                <div id="@collapse" class="div3 collapse card-body" data-parent="#accordionExample">
                            <!-- 訂單細項 -->
                            <div class="div4">
                                <div class="div4-1">
                                    <img src="@item.SitterPhoto">
                                </div>
                                <div class="div4-2">

                                    <div class="div4-2-1">
                                        <div>保姆名稱 &nbsp : &nbsp @item.SitterName </div>
                                        <div class="div4-2-2">保姆地址 &nbsp : &nbsp @item.FormattedAddress</div>
                                        <div>保姆電話 &nbsp : &nbsp @item.SitterPhone</div>
                                        <div>入宿日期 &nbsp : &nbsp @item.DateStart.ToString("yyyy/MM/dd") - @item.DateOver.ToString("yyyy/MM/dd")</div>
                                        <div>入宿貓咪 &nbsp : &nbsp @item.CatName</div>
                                        <div>總共費用 &nbsp : &nbsp 新台幣 @item.Total 元</div>
                                    </div>
                                </div>
                            </div>
                            <div class="div5">
                                <!-- <div class="comment-area"> -->
                                <span type="button" class="div5-1" data-order-id="@item.OrderId" data-status="2">完成訂單</span>
                            </div>
                        </div>
                    </button>
                    i++;
                }
            }


            <div class="div1-01"><i class="fa-solid fa-folder-open"></i> &nbsp 歷 &nbsp 史 &nbsp 訂 &nbsp 單</div>


            @foreach (var item in Model)
            {
                if (item.Status == 2)
                {
                    string collapse = "collapse" + i;

                    <button class="div1-1">

                        <!-- data-target="#collapse【1】"***需更改數字*** -->
                        <div data-toggle="collapse" data-target="#@collapse" class="div2">
                            <div class="div2-1">                                
                                <div class="div2-1-1"><i class="fa-solid fa-user-large"></i> &nbsp &nbsp 保姆名稱: @item.SitterName &nbsp</div>
                                        <div class="div2-1-2">| &nbsp &nbsp 入宿日期:@item.DateStart.ToString("yyyy年MM月dd日") - @item.DateOver.ToString("MM月dd日") &nbsp (共 @item.DateOver.Subtract(item.DateStart).ToString("%d") 日)</div>
                            </div>
                            <div class="div2-2">
                                <i class="fa-solid fa-angles-down"></i>
                            </div>
                        </div>
                        <!-- id="collapse【1】"***需更改數字***   -->
                                <div id="@collapse" class="div3-1 collapse card-body" data-parent="#accordionExample">
                            <!-- 訂單細項 -->
                            <div class="div4">
                                <div class="div4-1">
                                    <img src="@item.SitterPhoto" alt="">
                                </div>
                                <div class="div4-2">

                                    <div class="div4-2-1">
                                        <div>保姆名稱 &nbsp : &nbsp @item.SitterName </div>
                                        <div class="div4-2-2">保姆地址 &nbsp : &nbsp @item.FormattedAddress</div>
                                        <div>保姆電話 &nbsp : &nbsp @item.SitterPhone</div>
                                        <div>入宿日期 &nbsp : &nbsp @item.DateStart.ToString("yyyy/MM/dd") - @item.DateOver.ToString("yyyy/MM/dd")</div>
                                        <div>入宿貓咪 &nbsp : &nbsp @item.CatName</div>
                                        <div>總共費用 &nbsp : &nbsp 新台幣 @item.Total 元</div>
                                    </div>
                                </div>
                            </div>                                   
                        </div>
                    </button>
                    i++;
                }
            }
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.js"></script>

 <script>
     let clickedOrderId;

     $('.div5-1').on('click', function(){
         clickedOrderId = parseInt($(this).data('orderId'));
     })

    @*訂單確認*@
     $('.div5 div').on('click', function(){

         let orderId = $(this).data('orderId');
         let status = $(this).data('status');
         let title;

         if(status == 1){
             title = "" //接受訂單的內容
         }else{
             title = "" //拒絕訂單的內容
         }


         Swal.fire({
             title,
             icon: 'question',
             showCancelButton: true,
             confirmButtonText: '確定',
             cancelButtonText: '返回',
             heightAuto: false,

         }).then((result) => {

             if (result.isConfirmed) {

                 //執行後端的內容 
                 $.post('/Sitter/SetOrderStatus', {orderId,status}, function(){
                     //執行更新內容
                     $.get('/Sitter/SitterReserveRecord', function(data) {
                         $('#member-right-region').html(data);
                     })
                 })                            
             }
         })
     })
 </script>

 <script>
        //* 彈出評論
        $(".div5-1").click(function () {
            clickedOrderId = parseInt($(this).data('orderId'));
            Swal.fire(
                {
                    title: '',
                    width: 800,
                    padding: '2em',
                    color: '#fff',
                    background: "#171B20",
                    showConfirmButton: false,
                    showCloseButton: true,
                    backdrop: `rgba(0,0,0,0.4)`,
                    html: `<div class="div6-1 h2">
                        <i class="fa-solid fa-calendar-star"></i>
                        <span class="">保姆服務評價</span>
                        <i class="fa-solid fa-calendar-star"></i>
                    </div>


                    <div class="pop-comment-area">
                        <div class="div6-2">
                            <div class="pop-user-info">
                                <div class="div6-2-1"><i class="fa-solid fa-star"> &nbsp 評分 &nbsp （最高為5星）<div>
                                <div class="div8">
                                   <div class="div11">

                                         <ul id="div12">
                                             <li><i class="fa-solid fa-star"></i></li>
                                             <li><i class="fa-solid fa-star"></i></li>
                                             <li><i class="fa-solid fa-star"></i></li>
                                             <li><i class="fa-solid fa-star"></i></li>
                                             <li><i class="fa-solid fa-star"></i></li>
                                         </ul>

                                   </div>
                                </div>
                                <div class="div6-2-1"> <i class="fa-solid fa-feather-pointed"></i> &nbsp 評價 &nbsp （切勿人身攻擊）<div>
                               <input class="div9"></input>

                               <button class="div10">送 &nbsp 出</button>

                            </div>
                        </div>

                    </div>
                    `,
                })
                $('.div10').on('click', function(){
                    let comment = $('.div9').val();

                        $.get('/Sitter/SetOrderStatus', {orderId: clickedOrderId, status: 2, div12: clickeddiv12, comment}).then(()=>{
                            swal.clickConfirm();
                        }).then(()=>{
                            $.get('/Sitter/SitterReserveRecord', function(data) {
                                $('#member-right-region').html(data);
                            })
                        })

                })

                div7Create()

        })
    </script>
    <script>
        let clickeddiv12 = 1;

        function div7Create() {
           var div12 = document.getElementById("div12");
           var div12_li = div12.getElementsByTagName("li");
           var result = document.getElementById("result");
           var i = 0;
           var j = 0;
           var len = div12_li.length;


            for (i = 0; i < len; i++) {
                div12_li[i].index = i;

                div12_li[i].onmouseover = function () {

                    for (i = 0; i < 5; i++) {
                        div12_li[i].style.color = "rgb(97, 97, 97)";
                    }

                    for (i = 0; i <= this.index; i++) {
                        div12_li[i].style.color = "rgb(185, 150, 104)";
                    }

                    clickeddiv12 = i;


                }
            }
        }        
    </script>

